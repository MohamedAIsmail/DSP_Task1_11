<!DOCTYPE html>
<html lang="en" dir="ltr">

<head>
    <meta charset="utf-8">

    <title>Flask App </title>

    <!-- Bootstraps Java Scipts Links -->
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/css/bootstrap.min.css"
        integrity="sha384-Vkoo8x4CGsO3+Hhxv8T/Q5PaXtkKtu6ug5TOeNV6gBiFeWPGFN9MuhOf23Q9Ifjh" crossorigin="anonymous">
    <script src="https://code.jquery.com/jquery-3.4.1.slim.min.js"
        integrity="sha384-J6qa4849blE2+poT4WnyKhv5vZF5SrPo0iEjwBvKU7imGFAV0wwj1yYfoRSJoZ+n"
        crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.0/dist/umd/popper.min.js"
        integrity="sha384-Q6E9RHvbIyZFJoft+2mJbHaEWldlvI9IOYy5n3zV9zzTtmI3UksdQRVvoxMfooAo"
        crossorigin="anonymous"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/js/bootstrap.min.js"
        integrity="sha384-wfSDF2E50Y2D1uUdj0O3uMBJnjuUD4Ih7YwaYd1iqfktj0Uod8GCExl3Og8ifwB6"
        crossorigin="anonymous"></script>



    <!-- JQuery links  -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>


    <!--High CHART LIVE  -->
    <script src="http://code.highcharts.com/highcharts.js"></script>
    <script src="http://code.highcharts.com/highcharts-more.js"></script>
    <script src="http://code.highcharts.com/modules/exporting.js"></script>

    <!--Gauge  -->
    <script type="text/javascript" src="http://pubnub.github.io/eon/lib/eon.js"></script>


</head>

<body>

    <div class="jumbotron">
        <h1 class="text-center text-white">Welcome to our Sampling Studio! </h1>
    </div>
    <br>
    <br>

    <div class="container-fluid">

        <div class="row">

            <div class="col-5 jumbotron p-2 mx-1">

                <p>Add Signal</p>
    
                <form action="/action_page.php">
                    <input type="file" id="myFile" name="filename">
                    <input type="submit">
                </form>

            </div>
            <br>

            <div class="col-5 jumbotron p-2 mx-1">
                <h1 class="sensor2"> Save Signal</h1>
            </div>
            <br>



        </div>
    </div>


    <style>
        .jumbotron {
            widows: 150px;
            height: 220px;
            justify-content: center;
        }

        .row {
            justify-content: center;
        }
    </style>

    <div class="container-fluid">
        <!-- Example row of columns -->
        <div class="row">
            <div class="container-fluid" id="dataContainer">

            </div>
        </div>
    </div>
    <br>
    <br>
    <br>

<br /><br />
Sample frequency:
<input id="fsval" type="text" value="">
<input type="range" id="range" size="5" min="0.01" max="2.1" value="0.5" step=".01" />
<br />
<p id="output"> </p>

<div id="container" style="min-width: 400px; height: 400px; margin: 0 auto"></div>
<div id="container2" style="min-width: 400px; height: 400px; margin: 0 auto"></div>


    
    <script>

        var x_max = 100;
        var chart;

        function requestData(){
            var requests = $.get('/data');
            var tm = requests.done(function (result){
                var series = char.series[0],
                    shift = series.data.length >20;
                char.series[0].setData(result, true, shift);
                setTimeout(requestData, 1000);
            });
        }

        chart= new Highcharts.Chart({
            chart:
            {
                renderTo: 'container',
                type: 'line',
                marginRight: 130,
                marginBottom: 25,
                zoomType: "x",
                events: {
                    load: requestData
                }
            },
            title:
            {
                text: 'Signal Data',
                x : -20
            },
            xAxis: {
                title: {
                    text: 'Time (ms)',
                    margin: 80
                }
            },
            yAxis: {
                title: {
                    text: 'Amplitude',
                    margin: 80
                }
            },
            series: [{
                name: 'Sine Wave Values',
                color: 'rgba(40, 120, 120, 0.5)',
                data: calculate(),
                turboThreshold: 0
            },
                    {
                        name: 'Sampled Wave Values',
                        color: 'rgba(255, 0, 0, 1)',
                        data: calculateSampled(),
                        turboThreshold: 0
                    }]
    })

    function calculateY(x) {
            return Math.sin(x);
        }
    function calculateSampled() {
            var v = [];
            for (var xt = 0; xt <= x_max; xt += 1 / getRate()) {
                v.push({ x: xt, y: calculateY(xt) });
            }
            return v;
        }
    
    function calculate() {
            var v = [];
            for (var xt = 0; xt <= x_max; xt += .01) {
                v.push({ x: xt, y: calculateY(xt) });
            }
            return v;
        }
    
    function getRate() {
            return (+$("#range").val());
        }
    
    function plot() {
            chart.series[1].setData(calculateSampled());
        }

    $('#range').change(update);

    $("#fsval").change(function () {
        var val = $(this).val();
        val = Math.min(Math.max(val, $('#range').attr('min')), $('#range').attr('max'));
        $("#range").val(val);
        update();
        $(this).val(val);
    });

    function update() {
        $("#fsval").val(getRate());
        plot();
    }

    update();    

    </script>

</body>

